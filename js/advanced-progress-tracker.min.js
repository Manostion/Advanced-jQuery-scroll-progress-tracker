$.fn.progressTracker=function(l){function t(){i.find(".trackThis").each(function(l){var t=$(this),o=t.children(".ptSectionTitle"),e=o.text(),s=i.offset().top,c=t.offset().top-s,p=l+1,h=c/r()*100,S=$(".scrollStopContainer"),v=$(".vertScrollStopContainer"),T=$(".scrollStopTitles"),f=$(".vertScrollStopTitles");if(h>100&&(h=100),S.children(".stop"+p).css("left",h+"%"),v.children(".stop"+p).css("top",h+"%"),T.children(".stop"+p).css("left",h+"%"),T.children(".stopTitle.onlyActive").addClass("reached"),"beam"==d.horStyle?T.children(".stopTitle.onlyActive").css("left","-8px"):T.children(".stopTitle.onlyActive").css("left","0"),f.children(".stop"+p).css("top",h+"%"),$(window).scrollTop()<=i.find(".trackThis:first").offset().top-s+i.find(".trackThis:first").children(".ptSectionTitle").outerHeight()-1&&T.children(".stopTitle.onlyActive").text(""),$(window).scrollTop()>=c+o.outerHeight()){T.children(".stopTitle.onlyActive").text(e);$(window).scrollTop()+$(window).height();""!=d.finalStopTitle&&($(window).width()<=d.mobileThreshold?($(window).scrollTop()+$(window).height()>=i.offset().top+i.height()+2*a||$(window).scrollTop()+$(window).height()>=$(document).outerHeight())&&T.children(".stopTitle.onlyActive").text(d.finalStopTitle):$(window).scrollTop()+$(window).height()>=$(document).outerHeight()&&T.children(".stopTitle.onlyActive").text(d.finalStopTitle))}d.horOnlyActiveTitle?(T.children(".stop"+p).css("display","none"),T.children(".stopTitle.onlyActive").css("display","block")):(T.children(".stop"+p).css("display","block"),T.children(".stopTitle.onlyActive").css("display","none")),"top"==d.horTitlesOffset?T.children(".stopTitle").css("margin-left","8px"):"bottom"==d.horTitlesOffset?(T.children(".stopTitle").css("margin-top","38px").css("margin-left","8px"),T.children(".finalStopTitle").css("margin-top","38px")):(T.children(".stopTitle").css("margin-top","18px").css("margin-left","25px"),T.children(".finalStopTitle").css("margin-top","18px").css("margin-right","16px")),"fill"==d.horStyle&&T.children(".onlyActive").css("margin-top","0"),n()>=c?$(".stop"+p).addClass("reached"):$(".stop"+p).removeClass("reached"),n()>=r()?$(".finalStopCircle, .finalStopTitle").addClass("reached"):$(".finalStopCircle, .finalStopTitle").removeClass("reached")})}var o,e,i,s,r,n,c,a,d=$.extend({horTracker:!0,horInHeader:!1,horPosition:"top",horCenter:!0,horStyle:"fill",horMobile:!0,horMobileOnly:!1,horStops:!0,horNumbering:!0,horTitles:!1,horTitlesOffset:"bottom",horOnlyActiveTitle:!0,verTracker:!1,verPosition:"left",verStyle:"beam",verMobile:!1,verMobileOnly:!1,verStops:!0,verNumbering:!1,verTitles:!0,mobileThreshold:1300,trackAllHeadlines:!1,addFinalStop:!1,finalStopTitle:"",hovering:!0,linking:!0,skipHeadlines:!1,scrollSpeed:800,trackViewport:!0,trackViewportOnly:!1},l);r=function(){return i.outerHeight()+a},d.trackViewport?(c=$(window).scrollTop()+$(window).height(),n=function(){return $(window).scrollTop()+$(window).height()-i.offset().top}):(c=$(window).scrollTop(),n=function(){return $(window).scrollTop()-i.offset().top+e}),$(document).ready(function(){function l(){i.find(".trackThis").each(function(l){var t,o=$(this).children(".ptSectionTitle"),e=l+1,i=$(".scrollStopContainer"),s=$(".vertScrollStopContainer"),r=$(".scrollStopTitles"),n=$(".vertScrollStopTitles");if(t=o.attr("data-name")?o.attr("data-name"):o.text(),$(this).attr("id","Section"+e),$(this).children(".ptSectionTitle").attr({id:"SectionHeadline"+e}),i.append('<div class="stopCircle stop'+e+'" data-index="'+e+'" title="'+o.text()+'"></div>'),s.append('<div class="stopCircle stop'+e+'" data-index="'+e+'"></div>'),r.append('<div class="stopTitle stop'+e+'" data-index="'+e+'">'+t+"</div>"),n.append('<div class="stopTitle stop'+e+'" data-index="'+e+'">'+t+"</div>"),d.horNumbering&&(i.children(".stopCircle.stop"+e).append(e),d.addFinalStop)){var c=i.children(".stopCircle").length+1;i.children(".finalStopCircle").text(c)}if(d.verNumbering&&(s.children(".stopCircle.stop"+e).append(e),d.addFinalStop)){var c=s.children(".stopCircle").length+1;s.children(".finalStopCircle").text(c)}}),$(".scrollStopContainer").append($(".scrollStopContainer > .finalStopCircle")),$(window).resize()}if(d.trackAllHeadlines?$("h1, h2, h3, h4, h5, h6").addClass("ptSectionTitle"):$("h3").addClass("ptSectionTitle"),$(".ptSectionTitle.trackThis").length){var p=0;$(".ptSectionTitle.trackThis").each(function(){p++,$(this).removeClass("trackThis").wrap('<div id="Section'+p+'" class="trackThis"></div>');for(var l=!1;!l;)$("#Section"+p).next().length&&$("#Section"+p).next()[0]!=$("#Section"+p).siblings(".ptSectionTitle.trackThis")[0]?$("#Section"+p).append($("#Section"+p).next()):l=!0})}if(i=$("#TrackScrollProgress").length?$("#TrackScrollProgress"):$(document),a=(i.find(".trackThis").children(".ptSectionTitle:first").outerHeight(!0)-i.find(".trackThis").children(".ptSectionTitle:first").outerHeight())/2,d.horTracker?(d.horInHeader&&$("header").length?("bottom"==d.horInHeader?$("header").append('<div class="horizontalScrollProgress"></div>'):$("header").prepend('<div class="horizontalScrollProgress"></div>'),d.horMobileOnly&&$(".horizontalScrollProgress").addClass("mobileOnly")):$("body").append('<div class="horizontalScrollProgress fixed"></div>'),"max"in document.createElement("progress")?($(".horizontalScrollProgress").append('<progress class="scrollProgress"></progress>'),s=$(".scrollProgress")):($(".horizontalScrollProgress").append('<div class="scrollProgressContainer"><span class="scrollProgressBar"></span></div>'),s=$(".scrollProgressContainer")),"bottom"!=d.horPosition||d.horInHeader?d.horInHeader||$("body").css("padding-top",$(".horizontalScrollProgress").height()):($(".horizontalScrollProgress").addClass("bottom"),$("body").css("padding-bottom",$(".horizontalScrollProgress").height())),e=$(".horizontalScrollProgress").height()):e=0,d.horTracker&&($(".scrollProgress").length&&$(".scrollProgress").attr("value","0"),d.horTitles?($('<div class="scrollStopTitles"></div>').insertAfter(s),$(".scrollStopTitles").append('<div class="stopTitle onlyActive" style="font-weight: bold;"></div>')):s.addClass("untitled"),d.horStops&&$('<div class="scrollStopContainer"></div>').insertAfter(s),d.addFinalStop&&($(".scrollStopContainer").append('<div class="finalStopCircle" title="'+d.finalStopTitle+'"></div>'),d.horOnlyActiveTitle||$(".scrollStopTitles").append('<div class="finalStopTitle">'+d.finalStopTitle+"</div>")),d.horMobile||(s.addClass("desktopOnly"),$(".scrollStopContainer").addClass("desktopOnly"),$(".scrollStopTitles").addClass("desktopOnly")),d.horMobileOnly&&(s.removeClass("desktopOnly").addClass("mobileOnly"),$(".scrollStopContainer").removeClass("desktopOnly").addClass("mobileOnly"),$(".scrollStopTitles").removeClass("desktopOnly").addClass("mobileOnly")),"fill"==d.horStyle&&$(".horizontalScrollProgress").addClass("styleFill"),d.horCenter&&(s.addClass("centerAll"),$(".scrollStopTitles").addClass("centerAll"),$(".scrollStopContainer").addClass("centerAll"))),d.verTracker){$("body").append('<div class="verticalScrollProgress"><div class="verticalScrollProgressContainer"><div class="verticalScrollProgressBar"></div></div></div>'),"right"==d.verPosition&&$(".verticalScrollProgress").addClass("verRight");var h=$(".verticalScrollProgress");d.verMobile||h.addClass("desktopOnly"),d.verMobileOnly&&h.removeClass("desktopOnly").addClass("mobileOnly"),d.verStops&&h.append('<div class="vertScrollStopContainer"></div>'),d.verTitles?h.append('<div class="vertScrollStopTitles"></div>'):h.addClass("untitled"),d.addFinalStop&&($(".vertScrollStopContainer").append('<div class="finalStopCircle"></div>'),$(".vertScrollStopTitles").append('<div class="finalStopTitle">'+d.finalStopTitle+"</div>")),"fill"==d.verStyle&&$(".verticalScrollProgress").addClass("styleFill")}if($(".scrollProgress").length){var S=$(".scrollProgress");S.attr("max",r()),$(document).scroll(function(){c=d.trackViewport?$(window).scrollTop()+$(window).height():$(window).scrollTop(),i>=i.offset().top-e?($(window).resize(),S.attr("value",n())):S.attr("value","0")}),$(window).resize(function(){S.attr("max",r()).attr("value",n())})}else{var v,T,S=$("#ScrollProgressBar"),f=r(),g=function(){return v=n(),T=v/f*100,T>100&&(T=100),T+="%"},C=function(){S.css("width",g())};$(document).scroll(function(){c=d.trackViewport?$(window).scrollTop()+$(window).height():$(window).scrollTop(),c>=i.offset().top-e?($(window).resize(),S.css("width",g())):S.css("width","0%")}),$(window).resize(function(){C()})}var v,w,y=$(".verticalScrollProgressBar"),f=r(),m=function(){return v=n(),w=v/f*100,w>100&&(w=100),w+="%"},u=function(){y.css("height",m())};if($(document).scroll(function(){c=d.trackViewport?$(window).scrollTop()+$(window).height():$(window).scrollTop(),c>=i.offset().top-e?($(window).resize(),u()):y.css("height","0%"),$(window).width()<=d.mobileThreshold?(d.horTitles&&$(".scrollStopTitles").children(".onlyActive").addClass("ellipsis"),d.horOnlyActiveTitle||($(".scrollStopTitles").children(".stopTitle, .finalStopTitle").css("display","none"),$(".scrollStopTitles").children(".onlyActive").css("display","block"))):($(".scrollStopTitles").children(".stopTitle, .onlyActive").removeClass("ellipsis"),d.horOnlyActiveTitle?($(".scrollStopTitles").children(".stopTitle, .finalStopTitle").css("display","none"),$(".scrollStopTitles").children(".onlyActive").css("display","block")):($(".scrollStopTitles").children(".stopTitle, .finalStopTitle").css("display","block"),$(".scrollStopTitles").children(".onlyActive").css("display","none")))}),$(window).resize(function(){f=r(),u(),t(),$(window).width()<=d.mobileThreshold?($(".horizontalScrollProgress, .scrollProgress, .scrollProgressContainer, .scrollStopContainer, .scrollStopTitles, .verticalScrollProgress").addClass("smallDevice"),d.horOnlyActiveTitle||($(".scrollStopTitles").children(".stopTitle, .finalStopTitle").css("display","none"),$(".scrollStopTitles").children(".onlyActive").css("display","block"),d.horTitlesOffset||$(".scrollStopTitles").children(".onlyActive").css("margin-top","38px").css("margin-left","8px"))):($(".horizontalScrollProgress, .scrollProgress, .scrollProgressContainer, .scrollStopContainer, .scrollStopTitles, .verticalScrollProgress").removeClass("smallDevice"),d.horOnlyActiveTitle?($(".scrollStopTitles").children(".stopTitle, .finalStopTitle").css("display","none"),$(".scrollStopTitles").children(".onlyActive").css("display","block")):($(".scrollStopTitles").children(".stopTitle, .finalStopTitle").css("display","block"),$(".scrollStopTitles").children(".onlyActive").css("display","none"))),$(window).width()>=d.mobileThreshold+100?"right"==d.verPosition?$(".verticalScrollProgress").css("right","50px"):$(".verticalScrollProgress").css("left","50px"):"right"==d.verPosition?$(".verticalScrollProgress").css("right","0"):$(".verticalScrollProgress").css("left","0")}),l(),d.linking&&($(".stopCircle, .stopTitle").click(function(){o=d.skipHeadlines?$("#SectionHeadline"+$(this).attr("data-index")).offset().top+$("#SectionHeadline"+$(this).attr("data-index")).height()-a:$(window).width()<=d.mobileThreshold&&d.horTitles?$("#SectionHeadline"+$(this).attr("data-index")).offset().top+$("#SectionHeadline"+$(this).attr("data-index")).height()-a:$("#SectionHeadline"+$(this).attr("data-index")).offset().top-e,$("html, body").animate({scrollTop:o-e+1},d.scrollSpeed)}),$(".finalStopCircle, .finalStopTitle").click(function(){$("html, body").animate({scrollTop:i.offset().top+i.outerHeight()-$(window).height()/2},d.scrollSpeed)})),d.hovering){var k;$(".scrollStopContainer .stopCircle, .scrollStopTitles .stopTitle").hover(function(){k=$(this).attr("data-index"),$(".stopCircle, .stopTitle").removeClass("hover"),$(".scrollStopContainer .stop"+k+", .scrollStopTitles .stop"+k).addClass("hover")},function(){$(".stopCircle, .stopTitle").removeClass("hover")}),$(".vertScrollStopContainer .stopCircle, .vertScrollStopTitles .stopTitle").hover(function(){k=$(this).attr("data-index"),$(".stopCircle, .stopTitle").removeClass("hover"),$(".vertScrollStopContainer .stop"+k+", .vertScrollStopTitles .stop"+k).addClass("hover")},function(){$(".stopCircle, .stopTitle").removeClass("hover")}),$(".scrollStopContainer .finalStopCircle, .scrollStopTitles .finalStopTitle").hover(function(){$(".scrollStopContainer .finalStopCircle, .scrollStopTitles .finalStopTitle").addClass("hover")},function(){$(".finalStopCircle, .finalStopTitle").removeClass("hover")}),$(".vertScrollStopContainer .finalStopCircle, .vertScrollStopTitles .finalStopTitle").hover(function(){$(".vertScrollStopContainer .finalStopCircle, .vertScrollStopTitles .finalStopTitle").addClass("hover")},function(){$(".finalStopCircle, .finalStopTitle").removeClass("hover")})}$(document).scroll()})};
